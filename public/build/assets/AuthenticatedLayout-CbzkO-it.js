import{j as e,L as H,a as Q,r as a,b as E,c as V,u as we}from"./app-BrUyG7yk.js";import{D as S}from"./Dropdown-waCO41fP.js";import{T as ne}from"./ThemeToggle-Bw0JqV72.js";import{T as oe}from"./TextInput-CriA2SlH.js";import{_ as n}from"./lang-BBLCHUjz.js";import{M as ie}from"./Modal-BCZvBBvc.js";import{P as ye}from"./PrimaryButton-C22pO8mr.js";import{S as W}from"./SecondaryButton-CgUwEPPx.js";import{D as je}from"./DangerButton-7yz6ru8h.js";import{u as Ne}from"./useTheme-BcNvbsKF.js";function ke(l){return e.jsx("img",{...l,src:"/assets/img/logo-rmd.png",alt:"Logo RMD"})}function P({active:l=!1,className:p="",children:i,...d}){return e.jsx(H,{...d,className:"inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium leading-5 transition duration-150 ease-in-out focus:outline-none "+(l?"border-indigo-400 text-gray-900 focus:border-indigo-700 dark:border-indigo-600 dark:text-gray-100 ":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 focus:border-gray-300 focus:text-gray-700 dark:text-gray-400 dark:hover:border-gray-700 dark:hover:text-gray-300 dark:focus:border-gray-700 dark:focus:text-gray-300 ")+p,children:i})}function R({active:l=!1,className:p="",children:i,...d}){return e.jsx(H,{...d,className:`flex w-full items-start border-l-4 py-2 pe-4 ps-3 ${l?"border-indigo-400 bg-indigo-50 text-indigo-700 focus:border-indigo-700 focus:bg-indigo-100 focus:text-indigo-800 dark:border-indigo-600 dark:bg-indigo-900/50 dark:text-indigo-300 dark:focus:border-indigo-600 dark:focus:bg-indigo-900 dark:focus:text-indigo-200":"border-transparent text-gray-600 hover:border-gray-300 hover:bg-gray-50 hover:text-gray-800 focus:border-gray-300 focus:bg-gray-50 focus:text-gray-800 dark:text-gray-400 dark:hover:border-gray-600 dark:hover:bg-gray-700 dark:hover:text-gray-200 dark:focus:border-gray-600 dark:focus:bg-gray-700 dark:focus:text-gray-200"} text-base font-medium transition duration-150 ease-in-out focus:outline-none ${p}`,children:i})}function Ce({user:l}){const{translations:p}=Q().props,i=(t,r={})=>{let x=p?.[t]||t;return Object.keys(r).forEach(m=>{x=x.replace(":"+m,r[m])}),x},[d,h]=a.useState(!1),[o,v]=a.useState("chat"),[b,j]=a.useState(0),[w,y]=a.useState(""),[N,s]=a.useState([]),[c,g]=a.useState([]),[f,_]=a.useState(""),[u,k]=a.useState(null),[L,D]=a.useState(!1),[A,J]=a.useState([]),[B,O]=a.useState(()=>{if(!l?.id)return[];const t=localStorage.getItem(`offline_queue_${l.id}`);return t?JSON.parse(t):[]}),[Y,G]=a.useState(navigator.onLine),[$,K]=a.useState(-1);a.useEffect(()=>{const t=()=>{G(!0),X()},r=()=>G(!1);return window.addEventListener("online",t),window.addEventListener("offline",r),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",r)}},[B]),a.useEffect(()=>{l?.id&&localStorage.setItem(`offline_queue_${l.id}`,JSON.stringify(B))},[B,l?.id]);const X=async()=>{if(B.length===0)return;const t=[...B];O([]);for(const r of t)try{await Z(r.message,r.receiver_id,r.tempId)}catch{O(m=>[...m,r])}},Z=async(t,r,x=Date.now())=>{if(!Y){const C={id:x,tempId:x,message:t,sender_id:l.id,receiver_id:r,status:"offline",created_at:new Date().toISOString()};s(M=>[...M,C]),O(M=>[...M,C]);return}const m={id:x,message:t,sender_id:l.id,receiver_id:r,status:"sending",created_at:new Date().toISOString()};N.find(C=>C.id===x)||s(C=>[...C,m]),D(!0);try{const C=await E.post("/api/chat",{receiver_id:r,message:t});s(M=>M.map(z=>z.id===x?{...C.data,status:"sent"}:z))}catch(C){s(M=>M.map(z=>z.id===x?{...z,status:"failed"}:z)),J(M=>[...M,{...m,id:x}]),U(C,"sendMessage")}finally{D(!1)}},[le,T]=a.useState(!1),[de,ce]=a.useState(""),ee=a.useRef(null),F=a.useRef(null);a.useEffect(()=>{F.current=new Audio("https://assets.mixkit.co/active_storage/sfx/2354/2354-preview.mp3")},[]);const U=async(t,r)=>{console.error(`Chat Error [${r}]:`,t);try{await E.post("/api/log-error",{type:"chat",context:r,message:t.message,stack:t.stack,user_id:l.id})}catch{const m=JSON.parse(localStorage.getItem("chat_error_logs")||"[]");m.push({timestamp:new Date().toISOString(),context:r,error:t.message}),localStorage.setItem("chat_error_logs",JSON.stringify(m.slice(-20)))}},I=async t=>{if(t)try{const r=await E.get(`/api/chat/${t}`);s(r.data),await fe(t)}catch(r){U(r,"fetchMessages")}},[xe,ue]=a.useState(!0);a.useEffect(()=>{const t=()=>{ue(document.visibilityState==="visible")};return document.addEventListener("visibilitychange",t),()=>document.removeEventListener("visibilitychange",t)},[]);const q=async()=>{try{const r=(await E.get("/api/chat-unread")).data.count;$!==-1&&r>$&&ge(),j(r),K(r)}catch(t){console.warn("Unread count fetch failed",t)}},[te,he]=a.useState("Notification"in window?Notification.permission:"default"),me=async()=>{if(!("Notification"in window))return;const t=await Notification.requestPermission();he(t),t==="granted"&&new Notification(i("Notifications Enabled"),{body:i("You will now receive alerts for new messages"),icon:"/favicon.ico"})},ge=()=>{F.current&&F.current.play().catch(t=>console.log("Audio play failed",t)),xe?d||(ce(i("You have a new message!")),T(!0),setTimeout(()=>T(!1),5e3)):te==="granted"&&new Notification(i("New Message"),{body:i("You have a new message in live chat"),icon:"/favicon.ico",tag:"chat-notification",renotify:!0})},fe=async t=>{try{await E.patch(`/api/chat/${t}/read`);const r=await E.get("/api/chat-unread");j(r.data.count),K(r.data.count)}catch(r){console.error("Failed to mark as read",r)}},se=async(t="")=>{try{const r=await E.get("/api/online-users",{params:{query:t}});g(r.data)}catch(r){console.error("Failed to fetch online users",r)}};a.useEffect(()=>{const t=r=>{const{user:x}=r.detail;h(!0),v("chat"),k(x),I(x.id)};return window.addEventListener("start-chat",t),()=>window.removeEventListener("start-chat",t)},[]),a.useEffect(()=>{q();const t=setInterval(()=>{q()},2e3);return()=>clearInterval(t)},[$]),a.useEffect(()=>{if(d){se(f);const t=setInterval(()=>{se(f),u&&I(u.id)},3e3);return()=>clearInterval(t)}},[d,f,u]);const re=()=>{d||q(),h(!d)},pe=()=>{k(null),s([])},ve=()=>{ee.current?.scrollIntoView({behavior:"smooth"})};a.useEffect(()=>{d&&o==="chat"&&ve()},[N,d,o]);const be=async t=>{if(t&&t.preventDefault(),!w.trim()||!u||L)return;const r=w;y(""),await Z(r,u.id)},ae=async t=>{if(t.status==="offline"){Y&&X();return}D(!0);try{const r=await E.post("/api/chat",{receiver_id:t.receiver_id,message:t.message});r.status===201&&(s(x=>x.map(m=>m.id===t.id?{...r.data,status:"sent"}:m)),J(x=>x.filter(m=>m.id!==t.id)))}catch(r){U(r,"retryMessage")}finally{D(!1)}};return a.useEffect(()=>{if(A.length>0&&!L){const t=setTimeout(()=>{ae(A[0])},3e3);return()=>clearTimeout(t)}},[A,L]),l?.id?e.jsxs("div",{className:"fixed bottom-6 right-6 z-[9999] flex flex-col items-end",children:[le&&e.jsxs("div",{className:"mb-4 bg-white dark:bg-gray-800 border-l-4 border-blue-600 p-4 shadow-lg rounded animate-bounce flex items-center gap-3 cursor-pointer",onClick:()=>{h(!0),T(!1)},children:[e.jsx("div",{className:"bg-blue-100 dark:bg-blue-900 p-2 rounded-full",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:de}),e.jsx("p",{className:"text-xs text-gray-500",children:i("Click to open")})]}),e.jsx("button",{onClick:t=>{t.stopPropagation(),T(!1)},className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),d&&e.jsxs("div",{className:"mb-4 w-80 sm:w-96 h-[500px] rounded-lg bg-white shadow-xl overflow-hidden flex flex-col border border-gray-200 dark:bg-gray-800 dark:border-gray-700 transition-all duration-300 ease-in-out transform origin-bottom-right",children:[e.jsxs("div",{className:"bg-blue-600 p-0 text-white flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 pb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[u&&e.jsx("button",{onClick:pe,className:"mr-1 hover:bg-blue-700 rounded-full p-1",title:i("Back to Support"),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})})}),e.jsx("h3",{className:"font-semibold text-sm",children:u?u.name:i("Live Chat")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[te==="default"&&e.jsx("button",{onClick:me,className:"text-white hover:text-blue-200 transition-colors",title:i("Enable Notifications"),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})}),e.jsx("button",{onClick:re,className:"text-white hover:text-gray-200 focus:outline-none",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]}),!u&&e.jsxs("div",{className:"flex px-4 space-x-4",children:[e.jsx("button",{onClick:()=>v("chat"),className:`pb-2 text-sm font-medium border-b-2 transition-colors ${o==="chat"?"border-white text-white":"border-transparent text-blue-200 hover:text-white"}`,children:i("Messages")}),e.jsxs("button",{onClick:()=>v("users"),className:`pb-2 text-sm font-medium border-b-2 transition-colors flex items-center gap-1 ${o==="users"?"border-white text-white":"border-transparent text-blue-200 hover:text-white"}`,children:[i("Users"),e.jsx("span",{className:"bg-blue-500 text-white text-[10px] px-1.5 py-0.5 rounded-full",children:c.length})]})]})]}),e.jsxs("div",{className:"flex-1 overflow-hidden relative flex flex-col bg-gray-50 dark:bg-gray-900",children:[o==="chat"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 flex flex-col space-y-3",children:[N.length===0&&e.jsx("div",{className:"text-center text-gray-500 text-xs mt-4",children:i("No messages yet. Say hello!")}),N.map(t=>e.jsxs("div",{className:`flex flex-col max-w-[80%] ${t.sender_id===l.id?"self-end items-end":"self-start items-start"}`,children:[e.jsxs("div",{className:`px-4 py-2 rounded-lg text-sm relative group ${t.sender_id===l.id?"bg-blue-600 text-white rounded-br-none":"bg-white border border-gray-200 text-gray-800 rounded-bl-none dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200"} ${t.status==="failed"?"border-red-500":""} ${t.status==="offline"?"border-dashed border-gray-400 opacity-70":""}`,children:[t.message,t.status==="failed"&&t.sender_id===l.id&&e.jsx("button",{onClick:()=>ae(t),className:"absolute -left-8 top-1/2 -translate-y-1/2 text-red-500 hover:text-red-700",title:i("Retry"),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z",clipRule:"evenodd"})})})]}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx("span",{className:"text-[10px] text-gray-500 dark:text-gray-400",children:new Date(t.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),t.sender_id===l.id&&e.jsxs("span",{className:"text-[10px]",children:[t.status==="sending"&&e.jsxs("svg",{className:"animate-spin h-3 w-3 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t.status==="sent"&&!t.is_read&&e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),t.is_read&&e.jsxs("div",{className:"flex -space-x-1",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 text-blue-500",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 text-blue-500",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]}),t.status==="offline"&&e.jsx("span",{className:"text-[8px] text-gray-400 italic",children:"offline"}),t.status==="failed"&&e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 text-red-500",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})]})]})]},t.id)),e.jsx("div",{ref:ee})]}),e.jsx("form",{onSubmit:be,className:"p-3 bg-white border-t border-gray-200 dark:bg-gray-800 dark:border-gray-700",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(oe,{type:"text",value:w,onChange:t=>y(t.target.value),placeholder:i("Type your message..."),className:"w-full text-sm"}),e.jsx("button",{type:"submit",disabled:!w.trim(),className:"p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"})})})]})})]}),o==="users"&&e.jsxs("div",{className:"flex-1 flex flex-col h-full",children:[e.jsx("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:e.jsx(oe,{type:"text",value:f,onChange:t=>_(t.target.value),placeholder:i("Search users..."),className:"w-full text-sm"})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:c.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center h-full text-gray-500 dark:text-gray-400 p-4",children:e.jsx("p",{className:"text-sm",children:i("No active users found")})}):e.jsx("ul",{className:"divide-y divide-gray-100 dark:divide-gray-800",children:c.map(t=>e.jsxs("li",{onClick:()=>{k(t),v("chat"),I(t.id)},className:"flex items-center space-x-3 p-3 hover:bg-white dark:hover:bg-gray-800 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:t.avatar,alt:t.name,className:"w-10 h-10 rounded-full object-cover"}),e.jsx("span",{className:`absolute bottom-0 right-0 w-3 h-3 rounded-full border-2 border-gray-50 dark:border-gray-900 ${t.status==="online"?"bg-green-500":"bg-gray-400"}`})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:t.name}),e.jsxs("div",{className:"flex items-center text-xs text-gray-500 dark:text-gray-400",children:[e.jsx("span",{className:"capitalize mr-2 bg-gray-100 dark:bg-gray-700 px-1.5 rounded",children:t.role}),e.jsx("span",{className:"truncate",children:t.last_active})]})]})]},t.id))})})]})]})]}),e.jsxs("div",{className:"relative",children:[b>0&&!d&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full animate-bounce z-50 shadow-md",children:b}),e.jsx("button",{onClick:re,className:`${d?"scale-0 opacity-0":"scale-100 opacity-100"} transition-all duration-300 transform bg-blue-600 hover:bg-blue-700 text-white p-4 rounded-full shadow-lg flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500`,"aria-label":i("Open Chat"),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})})]})]}):null}function Se(){const[l,p]=a.useState(0),[i,d]=a.useState([]),[h,o]=a.useState([]),v=async()=>{try{const s=await window.axios.get(route("api.admin.schedule-messages.unread"));d(s.data),b(s.data,h)}catch(s){console.error("Failed to fetch notifications",s)}},b=(s,c)=>{p(s.length+c.length)};a.useEffect(()=>(v(),window.Echo&&window.Echo.private("admin.notifications").listen(".profile.photo.request",s=>{o(c=>{const g=[s.request,...c];return b(i,g),g})}),()=>{window.Echo&&window.Echo.leave("admin.notifications")}),[]);const j=async s=>{try{await window.axios.patch(route("api.admin.schedule-messages.read",s));const c=i.filter(g=>g.id!==s);d(c),b(c,h)}catch(c){console.error("Failed to mark as read",c),v()}},w=s=>{o(c=>{const g=c.filter(f=>f.id!==s);return b(i,g),g})},y=s=>{V.visit(route("schedule.index",{schedule_id:s.schedule_id}))},N=s=>{V.visit(route("admin.profile-photos.index")),w(s.id)};return e.jsx("div",{className:"relative ms-3",children:e.jsxs(S,{children:[e.jsx(S.Trigger,{children:e.jsx("span",{className:"inline-flex rounded-md",children:e.jsxs("button",{type:"button",className:"relative inline-flex items-center p-2 text-sm font-medium text-center text-gray-500 hover:text-gray-700 focus:outline-none dark:text-gray-400 dark:hover:text-gray-300",children:[e.jsx("svg",{className:"w-6 h-6","aria-hidden":"true",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z"})}),l>0&&e.jsx("div",{className:"absolute inline-flex items-center justify-center w-5 h-5 text-xs font-bold text-white bg-red-500 border-2 border-white rounded-full -top-1 -end-1 dark:border-gray-900",children:l})]})})}),e.jsxs(S.Content,{width:"80",children:[e.jsx("div",{className:"px-4 py-2 text-xs text-gray-400 border-b border-gray-100 dark:border-gray-700",children:n("Notifications")}),i.length===0&&h.length===0?e.jsx("div",{className:"px-4 py-2 text-sm text-gray-500 dark:text-gray-400",children:n("No new notifications")}):e.jsxs("div",{className:"max-h-64 overflow-y-auto",children:[h.map(s=>e.jsx("div",{className:"px-4 py-3 border-b border-gray-100 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 transition duration-150 ease-in-out cursor-pointer bg-blue-50 dark:bg-blue-900/20",onClick:()=>N(s),children:e.jsxs("div",{className:"flex justify-between items-start gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-blue-600 dark:text-blue-400 truncate",children:n("New Photo Request")}),e.jsx("p",{className:"text-sm text-gray-900 dark:text-gray-100 truncate",children:s.user?.name}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(s.created_at).toLocaleString()})]}),e.jsx("div",{className:"shrink-0",children:e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:n("Review")})})]})},`photo-${s.id}`)),i.map(s=>e.jsx("div",{className:"px-4 py-3 border-b border-gray-100 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 transition duration-150 ease-in-out cursor-pointer",onClick:()=>y(s),children:e.jsxs("div",{className:"flex justify-between items-start gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 truncate",children:s.user?.name}),e.jsx("p",{className:"text-xs text-gray-500 mb-1 truncate",children:s.schedule?.name}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 break-words",children:s.message}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:new Date(s.created_at).toLocaleString()})]}),e.jsx("button",{onClick:c=>{c.stopPropagation(),j(s.id)},className:"shrink-0 text-blue-600 hover:text-blue-800 dark:text-blue-400 p-1",title:n("Mark as read"),children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})})]})},`msg-${s.id}`))]})]})]})})}function Le({show:l,onClose:p}){const i=Q().props.auth.user,d=a.useRef(),[h,o]=a.useState(null),{data:v,setData:b,post:j,processing:w,errors:y,reset:N,clearErrors:s}=we({photo:null});a.useEffect(()=>{l||(N(),s(),o(null))},[l]);const c=_=>{const u=_.target.files[0];if(u){if(u.size>2*1024*1024){alert(n("File size must be less than 2MB")),_.target.value=null;return}b("photo",u);const k=new FileReader;k.onloadend=()=>{o(k.result)},k.readAsDataURL(u)}},g=_=>{_.preventDefault();const u=i.role==="mentor"?"mentor.profile-photo.request":"participant.profile-photo.request";j(route(u),{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{p(),o(null)}})},f=()=>{p(),N(),s(),o(null)};return e.jsx(ie,{show:l,onClose:f,children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:n("Update Profile Photo")}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:n("Upload a new profile photo. Max 2MB, JPG/PNG.")}),e.jsxs("div",{className:"mt-6 flex flex-col items-center",children:[e.jsxs("div",{className:"mb-4 relative",children:[e.jsx("div",{className:"w-32 h-32 rounded-full overflow-hidden border-4 border-gray-200 dark:border-gray-700 shadow-md bg-gray-100 dark:bg-gray-900",children:h?e.jsx("img",{src:h,alt:"New Photo Preview",className:"w-full h-full object-cover"}):i.profile_photo_url?e.jsx("img",{src:i.profile_photo_url,alt:"Current Photo",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center text-blue-600 dark:text-blue-400 text-4xl font-bold",children:i.name.charAt(0)})}),i.profile_photo_status==="pending"&&!h&&e.jsx("div",{className:"absolute bottom-0 right-0 bg-yellow-500 text-white text-xs px-2 py-1 rounded-full shadow-sm",children:n("Pending")})]}),e.jsxs("form",{onSubmit:g,className:"w-full",children:[e.jsx("input",{type:"file",ref:d,className:"hidden",onChange:c,accept:"image/png, image/jpeg, image/jpg"}),e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsx(W,{type:"button",onClick:()=>d.current.click(),children:n("Select New Photo")})}),y.photo&&e.jsx("div",{className:"mt-2 text-center text-sm text-red-600 dark:text-red-400",children:y.photo}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx(W,{onClick:f,disabled:w,children:n("Cancel")}),e.jsx(ye,{disabled:!v.photo||w,className:"ml-3",children:w?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),n("Uploading...")]}):n("Save")})]})]})]})]})})}function Oe({header:l,children:p}){const{auth:i,flash:d,locale:h}=Q().props,o=i?.user||{},v=o?.role||"participant",[b,j]=a.useState(!0),[w,y]=a.useState(!1),[N,s]=a.useState(!1);a.useEffect(()=>{j(!0);const L=setTimeout(()=>j(!1),5e3);return()=>clearTimeout(L)},[d]);const c=L=>{L.preventDefault(),y(!0)},g=()=>{localStorage.clear(),sessionStorage.clear(),y(!1),V.post(route("logout"))},[f,_]=a.useState(!1),{theme:u,toggleTheme:k}=Ne();return e.jsxs("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 transition-colors duration-200",children:[e.jsxs("nav",{className:"border-b border-gray-100 bg-white dark:bg-gray-800 dark:border-gray-700",children:[e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex h-16 justify-between",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex shrink-0 items-center",children:e.jsx(H,{href:"/",children:e.jsx(ke,{className:"block h-9 w-auto fill-current text-gray-800 dark:text-gray-200"})})}),e.jsxs("div",{className:"hidden space-x-8 sm:-my-px sm:ms-10 sm:flex",children:[e.jsx(P,{href:route("dashboard"),active:route().current("dashboard"),children:n("Dashboard")}),o.role==="participant"&&e.jsx(P,{href:route("rmd.index"),active:route().current("rmd.*"),children:n("RMD")}),o.role==="admin"&&e.jsx(P,{href:route("mentors.index"),active:route().current("mentors.index"),children:n("Mentors")}),(o.role==="admin"||o.role==="mentor")&&e.jsx(P,{href:route("participants.index"),active:route().current("participants.index"),children:n("Participants")}),o.role==="admin"&&e.jsx(e.Fragment,{children:e.jsx(P,{href:route("schedule.index"),active:route().current("schedule.index"),children:n("Schedule")})}),(o.role==="admin"||o.role==="mentor")&&e.jsx(P,{href:route("communication.index"),active:route().current("communication.index"),children:n("Communication")}),o.role==="admin"&&e.jsx(P,{href:route("rmd-report.index"),active:route().current("rmd-report.index"),children:n("RMD Report")})]})]}),e.jsxs("div",{className:"hidden sm:ms-6 sm:flex sm:items-center",children:[(o.role==="admin"||o.role==="mentor")&&e.jsx(Se,{}),e.jsx(ne,{theme:u,toggleTheme:k,className:"ms-3"}),e.jsx("div",{className:"relative ms-3",children:e.jsxs(S,{children:[e.jsx(S.Trigger,{children:e.jsx("span",{className:"inline-flex rounded-md",children:e.jsxs("button",{type:"button",className:"inline-flex items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-500 transition duration-150 ease-in-out hover:text-gray-700 focus:outline-none dark:bg-gray-800 dark:text-gray-400 dark:hover:text-gray-300",children:[o?.first_name_display||o?.name||n("User"),e.jsx("svg",{className:"-me-0.5 ms-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]})})}),e.jsxs(S.Content,{children:[e.jsx("div",{className:"block px-4 py-2 text-xs text-gray-400",children:n("Manage Account")}),e.jsx(S.Link,{href:route("profile.edit"),children:n("Profile")}),(v==="mentor"||v==="participant")&&e.jsx("button",{type:"button",className:"block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 transition duration-150 ease-in-out hover:bg-gray-100 focus:bg-gray-100 focus:outline-none dark:text-gray-300 dark:hover:bg-gray-800 dark:focus:bg-gray-800",onClick:()=>s(!0),children:n("Change Profile Photo")}),e.jsx("div",{className:"border-t border-gray-100 dark:border-gray-600 my-1"}),e.jsx("div",{className:"block px-4 py-2 text-xs text-gray-400",children:n("Language")}),e.jsx(S.Link,{as:"button",href:route("language.switch","id"),method:"post",preserveState:!0,preserveScroll:!0,onClick:()=>localStorage.setItem("locale","id"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Indonesia"}),h==="id"&&e.jsx("span",{className:"text-green-500",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]})}),e.jsx(S.Link,{as:"button",href:route("language.switch","en"),method:"post",preserveState:!0,preserveScroll:!0,onClick:()=>localStorage.setItem("locale","en"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"English"}),h==="en"&&e.jsx("span",{className:"text-green-500",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]})}),e.jsx("div",{className:"border-t border-gray-100 dark:border-gray-600 my-1"}),e.jsx(S.Link,{as:"button",type:"button",onClick:c,children:n("Log Out")})]})]})})]}),e.jsxs("div",{className:"-me-2 flex items-center sm:hidden",children:[e.jsx(ne,{theme:u,toggleTheme:k,className:"me-3"}),e.jsx("button",{onClick:()=>_(L=>!L),className:"inline-flex items-center justify-center rounded-md p-2 text-gray-400 transition duration-150 ease-in-out hover:bg-gray-100 hover:text-gray-500 focus:bg-gray-100 focus:text-gray-500 focus:outline-none dark:text-gray-500 dark:hover:bg-gray-900 dark:hover:text-gray-400 dark:focus:bg-gray-900 dark:focus:text-gray-400",children:e.jsxs("svg",{className:"h-6 w-6",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("path",{className:f?"hidden":"inline-flex",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"}),e.jsx("path",{className:f?"inline-flex":"hidden",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})]})})]})]})}),e.jsxs("div",{className:(f?"block":"hidden")+" sm:hidden",children:[e.jsxs("div",{className:"space-y-1 pb-3 pt-2",children:[e.jsx(R,{href:route("dashboard"),active:route().current("dashboard"),children:n("Dashboard")}),o.role==="participant"&&e.jsx(R,{href:route("rmd.index"),active:route().current("rmd.*"),children:n("RMD")}),o.role==="admin"&&e.jsx(R,{href:route("mentors.index"),active:route().current("mentors.index"),children:n("Mentors")}),(o.role==="admin"||o.role==="mentor")&&e.jsx(R,{href:route("participants.index"),active:route().current("participants.index"),children:n("Participants")}),o.role==="admin"&&e.jsxs(e.Fragment,{children:[e.jsx(R,{href:route("schedule.index"),active:route().current("schedule.index"),children:n("Schedule")}),e.jsx(R,{href:route("communication.index"),active:route().current("communication.index"),children:n("Communication")}),e.jsx(R,{href:route("rmd-report.index"),active:route().current("rmd-report.index"),children:n("RMD Report")})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pb-1 pt-4 dark:border-gray-600",children:[e.jsxs("div",{className:"px-4",children:[e.jsx("div",{className:"text-base font-medium text-gray-800 dark:text-gray-200",children:o.first_name_display||o.name}),e.jsx("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:o.email})]}),e.jsxs("div",{className:"mt-3 space-y-1",children:[e.jsx(R,{href:route("profile.edit"),children:n("Profile")}),e.jsx(R,{as:"button",type:"button",onClick:c,children:n("Log Out")})]})]})]})]}),l&&e.jsx("header",{className:"bg-white shadow dark:bg-gray-800 transition-colors duration-200",children:e.jsx("div",{className:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8",children:l})}),b&&d?.success&&e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 mt-4",children:e.jsxs("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative dark:bg-green-800 dark:text-green-100 dark:border-green-600",role:"alert",children:[e.jsx("span",{className:"block sm:inline",children:d.success}),e.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",onClick:()=>j(!1),children:e.jsxs("svg",{className:"fill-current h-6 w-6 text-green-500 dark:text-green-300",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:[e.jsx("title",{children:n("Close")}),e.jsx("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})]})})]})}),b&&d?.error&&e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 mt-4",children:e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative dark:bg-red-800 dark:text-red-100 dark:border-red-600",role:"alert",children:[e.jsx("span",{className:"block sm:inline",children:d.error}),e.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",onClick:()=>j(!1),children:e.jsxs("svg",{className:"fill-current h-6 w-6 text-red-500 dark:text-red-300",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:[e.jsx("title",{children:n("Close")}),e.jsx("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})]})})]})}),e.jsx("main",{children:p}),e.jsx(Ce,{user:o}),e.jsx(ie,{show:w,onClose:()=>y(!1),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:n("Are you sure you want to log out?")}),e.jsxs("div",{className:"mt-6 flex justify-end",children:[e.jsx(W,{onClick:()=>y(!1),children:n("Cancel")}),e.jsx(je,{className:"ms-3",onClick:g,children:n("Yes, Log Out")})]})]})}),e.jsx(Le,{show:N,onClose:()=>s(!1)})]})}export{Oe as A};
