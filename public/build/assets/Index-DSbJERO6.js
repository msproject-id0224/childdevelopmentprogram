import{a as ae,r as c,u as re,j as e,H as ie}from"./app-BrUyG7yk.js";import{A as de}from"./AuthenticatedLayout-CbzkO-it.js";import{_ as a}from"./lang-BBLCHUjz.js";import{M as oe}from"./Modal-BCZvBBvc.js";import{I as m}from"./InputLabel-BMpDstnu.js";import{T as h}from"./TextInput-CriA2SlH.js";import{I as g}from"./InputError-DlkBn7UG.js";import{P as ne}from"./PrimaryButton-C22pO8mr.js";import{S as $}from"./SecondaryButton-CgUwEPPx.js";import{D as le}from"./DangerButton-7yz6ru8h.js";import"./Dropdown-waCO41fP.js";import"./transition-oyyIfUlq.js";import"./ThemeToggle-Bw0JqV72.js";import"./useTheme-BcNvbsKF.js";function we({auth:P,schedules:b}){const{locale:w}=ae().props,[C,M]=c.useState(new Date),[E,f]=c.useState(!1),[p,S]=c.useState("add"),[y,D]=c.useState(null),[v,j]=c.useState("details"),[F,L]=c.useState([]),[T,I]=c.useState(!1);c.useEffect(()=>{const t=new URLSearchParams(window.location.search).get("schedule_id");if(t&&b.length>0){const r=b.find(N=>N.id===parseInt(t));r&&(k(),_(),i({name:r.name,date:r.date,start_time:r.start_time?r.start_time.substring(0,5):"",end_time:r.end_time?r.end_time.substring(0,5):"",description:r.description,priority:r.priority,pic:r.pic,location:r.location||"",status:r.status||"scheduled"}),D(r),S("edit"),j("messages"),f(!0),window.history.replaceState({},document.title,window.location.pathname))}},[b]);const{data:d,setData:i,post:U,patch:q,delete:B,processing:A,errors:o,reset:k,clearErrors:_}=re({name:"",date:"",start_time:"",end_time:"",description:"",priority:"medium",pic:"",location:"",status:"scheduled"}),H=(s,t)=>new Date(s,t+1,0).getDate(),O=(s,t)=>new Date(s,t,1).getDay(),n=C.getFullYear(),u=C.getMonth(),R=H(n,u),W=O(n,u),Y=()=>{M(new Date(n,u-1,1))},G=()=>{M(new Date(n,u+1,1))},z=s=>{const t=`${n}-${String(u+1).padStart(2,"0")}-${String(s).padStart(2,"0")}`;k(),_(),i({name:"",date:t,start_time:"",end_time:"",description:"",priority:"medium",pic:P.user.name,location:"",status:"scheduled"}),S("add"),j("details"),D(null),f(!0)},J=(s,t)=>{s.stopPropagation(),k(),_(),i({name:t.name,date:t.date,start_time:t.start_time?t.start_time.substring(0,5):"",end_time:t.end_time?t.end_time.substring(0,5):"",description:t.description,priority:t.priority,pic:t.pic,location:t.location||"",status:t.status||"scheduled"}),S("edit"),j("details"),D(t),f(!0)},K=async s=>{I(!0);try{const t=await window.axios.get(route("api.schedules.messages",s));L(t.data)}catch(t){console.error(t)}finally{I(!1)}},Q=async s=>{try{await window.axios.patch(route("api.admin.schedule-messages.archive",s)),L(t=>t.filter(r=>r.id!==s))}catch(t){console.error(t)}};c.useEffect(()=>{v==="messages"&&y&&K(y.id)},[v,y]);const x=()=>{f(!1),k()},V=s=>{s.preventDefault(),p==="add"?U(route("schedule.store"),{onSuccess:()=>x()}):q(route("schedule.update",y.id),{onSuccess:()=>x()})},X=()=>{confirm(a("Are you sure you want to delete this activity?"))&&B(route("schedule.destroy",y.id),{onSuccess:()=>x()})},Z=b.filter(s=>{const t=new Date(s.date);return t.getMonth()===u&&t.getFullYear()===n}),ee=s=>Z.filter(t=>new Date(t.date).getDate()===s),te=()=>{const s=[];for(let t=0;t<W;t++)s.push(e.jsx("div",{className:"h-24 sm:h-32 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700"},`empty-${t}`));for(let t=1;t<=R;t++){const r=ee(t),N=new Date().toDateString()===new Date(n,u,t).toDateString();s.push(e.jsxs("div",{className:`h-24 sm:h-32 border border-gray-200 dark:border-gray-700 p-1 transition duration-150 ease-in-out hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer overflow-y-auto ${N?"bg-blue-50 dark:bg-blue-900/20":"bg-white dark:bg-gray-800"}`,onClick:()=>z(t),children:[e.jsx("div",{className:`text-right text-sm font-semibold mb-1 ${N?"text-blue-600 dark:text-blue-400":"text-gray-700 dark:text-gray-300"}`,children:t}),e.jsx("div",{className:"space-y-1",children:r.map(l=>e.jsxs("div",{onClick:se=>J(se,l),className:`text-xs p-1 rounded truncate text-white cursor-pointer hover:opacity-80 ${l.priority==="high"?"bg-red-500":l.priority==="medium"?"bg-blue-500":"bg-green-500"}`,title:`${l.start_time} - ${l.name}`,children:[l.start_time&&e.jsx("span",{className:"mr-1",children:l.start_time.substring(0,5)}),l.name]},l.id))})]},t))}return s};return e.jsxs(de,{header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:a("Schedule")}),children:[e.jsx(ie,{title:a("Schedule")}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6 text-gray-900 dark:text-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("button",{onClick:Y,className:"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),e.jsxs("h3",{className:"text-xl font-bold",children:[new Date(n,u).toLocaleString(w==="id"?"id-ID":"en-US",{month:"long"})," ",n]}),e.jsx("button",{onClick:G,className:"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})})]}),e.jsx("div",{className:"grid grid-cols-7 gap-0 mb-2 text-center font-bold text-gray-600 dark:text-gray-400",children:[...Array(7)].map((s,t)=>e.jsx("div",{children:new Date(2024,0,7+t).toLocaleString(w==="id"?"id-ID":"en-US",{weekday:"short"})},t))}),e.jsx("div",{className:"grid grid-cols-7 gap-0",children:te()}),e.jsxs("div",{className:"mt-4 flex gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded mr-1"})," ",a("High Priority")]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded mr-1"})," ",a("Medium Priority")]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded mr-1"})," ",a("Low Priority")]})]})]})})})}),e.jsx(oe,{show:E,onClose:x,children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-4",children:p==="add"?a("Add Activity"):a("Edit Activity")}),p==="edit"&&e.jsxs("div",{className:"flex border-b border-gray-200 dark:border-gray-700 mb-4",children:[e.jsx("button",{className:`py-2 px-4 text-sm font-medium ${v==="details"?"text-indigo-600 border-b-2 border-indigo-600":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"}`,onClick:()=>j("details"),children:a("Details")}),e.jsx("button",{className:`py-2 px-4 text-sm font-medium ${v==="messages"?"text-indigo-600 border-b-2 border-indigo-600":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"}`,onClick:()=>j("messages"),children:a("Communication")})]}),v==="details"?e.jsxs("form",{onSubmit:V,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"name",value:a("Activity Name")}),e.jsx(h,{id:"name",className:"mt-1 block w-full",value:d.name,onChange:s=>i("name",s.target.value),required:!0,isFocused:!0}),e.jsx(g,{message:o.name,className:"mt-2"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"date",value:a("Date")}),e.jsx(h,{id:"date",type:"date",className:"mt-1 block w-full",value:d.date,onChange:s=>i("date",s.target.value),required:!0}),e.jsx(g,{message:o.date,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"priority",value:a("Priority")}),e.jsxs("select",{id:"priority",className:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm",value:d.priority,onChange:s=>i("priority",s.target.value),children:[e.jsx("option",{value:"low",children:a("Low")}),e.jsx("option",{value:"medium",children:a("Medium")}),e.jsx("option",{value:"high",children:a("High")})]}),e.jsx(g,{message:o.priority,className:"mt-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"start_time",value:a("Start Time")}),e.jsx(h,{id:"start_time",type:"time",className:"mt-1 block w-full",value:d.start_time,onChange:s=>i("start_time",s.target.value),required:!0}),e.jsx(g,{message:o.start_time,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"end_time",value:a("End Time")}),e.jsx(h,{id:"end_time",type:"time",className:"mt-1 block w-full",value:d.end_time,onChange:s=>i("end_time",s.target.value),required:!0}),e.jsx(g,{message:o.end_time,className:"mt-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"location",value:a("Location")}),e.jsx(h,{id:"location",className:"mt-1 block w-full",value:d.location,onChange:s=>i("location",s.target.value)}),e.jsx(g,{message:o.location,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"status",value:a("Status")}),e.jsxs("select",{id:"status",className:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm",value:d.status,onChange:s=>i("status",s.target.value),children:[e.jsx("option",{value:"scheduled",children:a("Scheduled")}),e.jsx("option",{value:"ongoing",children:a("Ongoing")}),e.jsx("option",{value:"completed",children:a("Completed")}),e.jsx("option",{value:"cancelled",children:a("Cancelled")})]}),e.jsx(g,{message:o.status,className:"mt-2"})]})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"description",value:a("Description")}),e.jsx("textarea",{id:"description",className:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm",rows:"3",value:d.description,onChange:s=>i("description",s.target.value)}),e.jsx(g,{message:o.description,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"pic",value:a("PIC")}),e.jsx(h,{id:"pic",className:"mt-1 block w-full",value:d.pic,onChange:s=>i("pic",s.target.value),required:!0}),e.jsx(g,{message:o.pic,className:"mt-2"})]}),e.jsxs("div",{className:"flex items-center justify-end mt-6",children:[p==="edit"&&e.jsx(le,{type:"button",onClick:X,className:"mr-auto",disabled:A,children:a("Delete")}),e.jsx($,{onClick:x,className:"mr-3",children:a("Cancel")}),e.jsx(ne,{disabled:A,children:p==="add"?a("Add"):a("Save Changes")})]})]}):e.jsxs("div",{className:"space-y-4",children:[T?e.jsx("div",{className:"text-center py-4 text-gray-500",children:a("Loading messages...")}):F.length===0?e.jsx("div",{className:"text-center py-4 text-gray-500",children:a("No messages found.")}):e.jsx("div",{className:"max-h-96 overflow-y-auto space-y-4",children:F.map(s=>e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{className:"font-semibold text-sm text-gray-900 dark:text-gray-100",children:s.user?.name||"Unknown User"}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(s.created_at).toLocaleString(w==="id"?"id-ID":"en-US")})]}),e.jsx("div",{className:"mt-1 text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:s.message}),e.jsx("div",{className:"mt-2 flex justify-end",children:e.jsx("button",{onClick:()=>Q(s.id),className:"text-xs text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 font-medium",children:a("Archive")})})]},s.id))}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx($,{onClick:x,children:a("Close")})})]})]})})]})}export{we as default};
