import{r as c,a as I,u as L,j as e,c as b}from"./app-BF_e_Rdy.js";import{_ as t}from"./lang-BBLCHUjz.js";import{T as i}from"./TextInput-B1g3ssf1.js";import{P as D}from"./PrimaryButton-kgonJzl3.js";import{S as M}from"./SecondaryButton-Dh5JYrG7.js";import{M as $}from"./Modal-DWOZPDE9.js";import{I as m}from"./InputLabel-DFaqN2cU.js";import{I as x}from"./InputError-C-0TgvcP.js";import"./transition-DGGVtMAX.js";function G(){const[u,N]=c.useState({data:[]}),[r,_]=c.useState(""),[v,g]=c.useState(!1),[j,f]=c.useState(null),{auth:h}=I().props,{data:n,setData:l,patch:k,processing:w,errors:d,reset:S,clearErrors:y}=L({first_name:"",last_name:"",email:"",job_title:"",phone_number:""}),o=async(a=route("api.admins.index"))=>{g(!0);try{const s=new URLSearchParams;r&&s.append("search",r),a.includes("?")||(r?a+=`?search=${r}`:r&&!a.includes("search=")&&(a+=(a.includes("?")?"&":"?")+`search=${r}`));const T=await axios.get(a);N(T.data)}catch(s){console.error("Failed to fetch admins",s)}finally{g(!1)}};c.useEffect(()=>{const a=setTimeout(()=>{o()},300);return()=>clearTimeout(a)},[r]);const C=a=>{f(a),l({first_name:a.first_name||"",last_name:a.last_name||"",email:a.email||"",job_title:a.job_title||"",phone_number:a.phone_number||""}),y()},p=()=>{f(null),S(),y()},E=a=>{a.preventDefault(),k(route("api.admins.update",j.id),{onSuccess:()=>{p(),o()}})},A=async a=>{if(a.id!==h.user.id)try{await b.patch(route("api.admins.toggle-status",a.id),{},{preserveScroll:!0,onSuccess:()=>o()})}catch(s){console.error("Failed to toggle status",s)}},F=async a=>{if(confirm(t("Are you sure you want to delete this admin?")))try{await b.delete(route("api.admins.destroy",a.id),{preserveScroll:!0,onSuccess:()=>o()})}catch(s){console.error("Failed to delete user",s)}};return e.jsxs("section",{className:"space-y-6",children:[e.jsxs("header",{children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:t("Daftar Admin")}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:t("Kelola administrator yang terdaftar.")})]}),e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("div",{className:"w-full max-w-sm",children:e.jsx(i,{placeholder:t("Cari admin..."),value:r,onChange:a=>_(a.target.value),className:"w-full"})})}),e.jsx("div",{className:"relative overflow-x-auto shadow-md sm:rounded-lg",children:e.jsxs("table",{className:"w-full text-sm text-left text-gray-500 dark:text-gray-400",children:[e.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3",children:t("Nama")}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:t("Email")}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:t("Jabatan")}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:t("Status")}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:t("Terdaftar")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right",children:t("Aksi")})]})}),e.jsx("tbody",{children:v?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center",children:t("Loading...")})}):u.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center",children:t("Tidak ada admin ditemukan.")})}):u.data.map(a=>e.jsxs("tr",{className:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600",children:[e.jsxs("td",{className:"px-6 py-4 font-medium text-gray-900 dark:text-white whitespace-nowrap",children:[a.name,a.id===h.user.id&&e.jsxs("span",{className:"ml-2 text-xs text-indigo-600 dark:text-indigo-400",children:["(",t("Anda"),")"]})]}),e.jsx("td",{className:"px-6 py-4",children:a.email}),e.jsx("td",{className:"px-6 py-4",children:a.job_title||"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${a.is_active?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"}`,children:a.is_active?t("Aktif"):t("Nonaktif")})}),e.jsx("td",{className:"px-6 py-4",children:new Date(a.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-right space-x-2",children:a.id!==h.user.id&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>C(a),className:"font-medium text-indigo-600 dark:text-indigo-500 hover:underline",children:t("Edit")}),e.jsx("button",{onClick:()=>A(a),className:"font-medium text-blue-600 dark:text-blue-500 hover:underline",children:a.is_active?t("Nonaktifkan"):t("Aktifkan")}),e.jsx("button",{onClick:()=>F(a),className:"font-medium text-red-600 dark:text-red-500 hover:underline",children:t("Hapus")})]})})]},a.id))})]})}),u.links&&e.jsx("div",{className:"flex justify-center mt-4 space-x-1",children:u.links.map((a,s)=>e.jsx("button",{onClick:()=>a.url&&o(a.url),dangerouslySetInnerHTML:{__html:a.label},className:`px-3 py-1 rounded ${a.active?"bg-indigo-600 text-white":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"} ${a.url?"":"opacity-50 cursor-not-allowed"}`,disabled:!a.url},s))}),e.jsx($,{show:!!j,onClose:p,children:e.jsxs("form",{onSubmit:E,className:"p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:t("Edit Admin")}),e.jsxs("div",{className:"mt-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"edit_first_name",value:t("Nama Depan")}),e.jsx(i,{id:"edit_first_name",value:n.first_name,onChange:a=>l("first_name",a.target.value),className:"mt-1 block w-full",required:!0}),e.jsx(x,{message:d.first_name,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"edit_last_name",value:t("Nama Belakang")}),e.jsx(i,{id:"edit_last_name",value:n.last_name,onChange:a=>l("last_name",a.target.value),className:"mt-1 block w-full"}),e.jsx(x,{message:d.last_name,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"edit_email",value:t("Email")}),e.jsx(i,{id:"edit_email",type:"email",value:n.email,onChange:a=>l("email",a.target.value),className:"mt-1 block w-full",required:!0}),e.jsx(x,{message:d.email,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"edit_job_title",value:t("Jabatan")}),e.jsx(i,{id:"edit_job_title",value:n.job_title,onChange:a=>l("job_title",a.target.value),className:"mt-1 block w-full"}),e.jsx(x,{message:d.job_title,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"edit_phone_number",value:t("Nomor Telepon")}),e.jsx(i,{id:"edit_phone_number",value:n.phone_number,onChange:a=>l("phone_number",a.target.value),className:"mt-1 block w-full"}),e.jsx(x,{message:d.phone_number,className:"mt-2"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end",children:[e.jsx(M,{onClick:p,children:t("Batal")}),e.jsx(D,{className:"ml-3",disabled:w,children:t("Simpan")})]})]})})]})}export{G as default};
